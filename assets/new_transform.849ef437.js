var y=Object.defineProperty;var b=(s,t,e)=>t in s?y(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var a=(s,t,e)=>(b(s,typeof t!="symbol"?t+"":t,e),e);import{m as h,r as c}from"./matrix.eb4bdb6d.js";class j{constructor(t){a(this,"el");a(this,"ctx");a(this,"width");a(this,"height");a(this,"degree_y");const e=t.clientWidth,i=t.clientWidth;t.width=e,t.height=i,this.el=t,this.ctx=t.getContext("2d"),this.width=e,this.height=i,this.degree_y=0}mirror_coordinate(){this.el.style.transformOrigin="center",this.el.style.transform="scale(1,-1)"}translate_origin(t){typeof t=="string"?(t=P(t,this),g(t,this.ctx)):g(t,this.ctx)}draw_point(t,e=1){this.ctx.beginPath(),this.ctx.fillStyle="#000",this.ctx.arc(t[0],t[1],e,0,2*Math.PI),this.ctx.fill(),this.ctx.closePath()}draw_line(t,e){this.ctx.beginPath(),this.ctx.moveTo(t[0],t[1]),this.ctx.lineTo(e[0],e[1]),this.ctx.stroke(),this.ctx.closePath()}draw_vector_order(t){for(let e=0;e<t.length;e++){const i=(e+1)%t.length;this.draw_line(t[e],t[i])}}draw_x(){this.draw_line(u(-this.width/2,0),u(this.width/2,0))}draw_z(){this.draw_line(u(0,-this.height/2),u(0,this.height/2))}draw_y(t){const e=t&&(this.degree_y=-t)&&this.degree_y||this.degree_y;let i,n;D(e)?(i=this.width/2,n=this.width/2*Math.tan(e/180*Math.PI)):(n=this.height/2,i=this.height/2/Math.tan(e/180*Math.PI)),this.draw_line(u(-i,-n),u(i,n))}clear_ctx(){this.ctx.clearRect(-this.width,-this.height,this.width*2,this.height*2)}}function d(s,t){return s=s%360,Math.abs(Math.abs(s)-t)}function D(s){return d(s,0)<=45||d(s,180)<=45}function u(s,t){return[s,t]}function P(s,t){const e=t.el.width,i=t.el.height;switch(s){case"center":return{x:e/2,y:i/2};default:return{x:0,y:0}}}function g(s,t){t.translate(s.x,s.y)}function T(s){return[[s[0],0],[0,s[1]]]}function z(s,t){let e;return t.length==2?e=h(T(s)):(e=[],console.error("don't support matrix 3 x 3 now")),c(t,e)}function B(s,t){return t.map(e=>z(s,e))}function V(s){return[[Math.cos(s),Math.sin(s)],[-Math.sin(s),Math.cos(s)]]}function S(s,t){let e;return s=f(s),t.length==2?e=h(V(s)):(e=[],console.error("don't support matrix 3 x 3")),c(t,e)}function G(s,t){return t.map(e=>S(s,e))}function v(s){return[[1,0],[Math.tan(f(s)),1]]}function F(s){return[[1,Math.tan(f(s))],[0,1]]}function I(s,t){const[e,i]=s;return A(i,q(e,t))}function q(s,t){const e=h(v(s));return c(t,e)}function A(s,t){const e=h(F(s));return c(t,e)}function J(s,t){return t.map(e=>I(s,e))}const C=[[1,0],[0,-1]],E=[[-1,0],[0,1]];function R(s,t){let e;return t.length==2?s==1?e=h(C):s==-1?e=h(E):(e=[],console.error("don't get a available factor")):(e=[],console.error("don't support matrix 3 x 3")),c(t,e)}function K(s,t){return t.map(e=>R(s,e))}function f(s){return s/180*Math.PI}function H(s){return s.map(t=>(t.push(1),t))}function N(s){return s.push(1),s}function W(s,t){const e=N(t),i=H([[1,0],[0,1]]);return i.push([...s,1]),c(e,h(i))}function L(s,t){return t.map(e=>W(s,e)).map(e=>e==null?void 0:e.slice(0,e.length-1))}function Q(s){return parseFloat(s.value)}function Z(s){const e=s.value.split(",").slice();return e.length>2&&console.warn("only use the first and second factor"),e.length==1&&(e[1]=e[0]),e.map(i=>parseFloat(i))}function $(s){const t=s.value.trim();return t=="x"?1:t=="y"?-1:console.error("error input factor on mirror transform")}function tt(s){const e=s.value.split(",").slice();if(e.length>4)return console.error("can only put 4 factors"),[void 0,void 0,void 0];const[i,n,r,o]=e.map(l=>parseFloat(l));return e.length==4||e.length==3?m(i,n,r,o):(console.error("miss too much factors"),[void 0,void 0,void 0])}function k(s,t){const e=s.length,i=t.length;if(s.length!==t.length)return!1;{const n=Math.max(e,i);for(let r=0;r<n;r++){const o=s[r],l=t[r];if(o===void 0||l===void 0)return!1;if(o!==l)return!1}}return!0}function m(s,t,e,i=0){return[s,t,e,i]}class et{constructor(t,e){a(this,"aspects");a(this,"d_ctx");a(this,"origin_aspects");a(this,"axis");this.aspects=t,this.origin_aspects=t.map(i=>i.map(n=>n.slice())),this.d_ctx=e,this.axis=m(0,1,0)}draw(){const t=this.aspects[0].map(i=>_(i)),e=this.aspects[1].map(i=>_(i));p(t,this.d_ctx),p(e,this.d_ctx),O(t,e,this.d_ctx)}rotate(t,e){const i=f(t);e=U(e||this.axis),k(this.axis,e)||(this.axis=e,this.origin_aspects=this.aspects,console.log("change"));const n=e[0],r=e[1],o=e[2];console.log("x: ",e);const l=h([[n**2*(1-Math.cos(i))+Math.cos(i),n*r*(1-Math.cos(i))+o*Math.sin(i),n*o*(1-Math.cos(i)-r*Math.sin(i)),0],[n*r*(1-Math.cos(i))-o*Math.sin(i),r**2*(1-Math.cos(i))+Math.cos(i),r*o*(1-Math.cos(i)+n*Math.sin(i)),0],[n*o*(1-Math.cos(i))+r*Math.sin(i),o*r*(1-Math.cos(i))-n*Math.sin(i),o**2*(1-Math.cos(i))+Math.cos(i),0],[0,0,0,1]]),x=this.origin_aspects.map(M=>M.map(w=>c(w,l)));console.log(x),this.aspects=x}}function _(s){return s.slice(0,2)}function p(s,t){s.forEach((e,i)=>{const n=(i+1)%s.length;t.draw_line(e,s[n])})}function O(s,t,e,i){i=i||s.map((n,r)=>r),i.forEach((n,r)=>{e.draw_line(s[r],t[n])})}function st(...s){return[...s]}function U(s){const t=Math.sqrt(s.reduce((e,i)=>e+i**2,0));return s.map(e=>e/t)}export{k as A,j as D,st as N,et as S,m as V,Z as a,Q as b,J as c,$ as d,L as e,tt as i,K as m,G as r,B as s};
